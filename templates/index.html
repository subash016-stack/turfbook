<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚öΩ TurfFlow ¬∑ smart booking</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="dashboard">
        
        <div class="header-glass">
            <h1>
                <i class="fas fa-futbol"></i> 
                TurfFlow<span style="font-weight:300; font-size:1.2rem; margin-left:10px; opacity:0.8;">¬∑ smart slots</span>
            </h1>
            <div class="stats-badge">
                <i class="fas fa-calendar-check"></i> 
                <span id="bookingCount">0</span> active bookings
            </div>
        </div>

        <!-- main interactive grid: form + table advanced -->
        <div class="row-split">
            <!-- LEFT CARD: BOOKING FORM (enhanced) -->
            <div class="card-modern">
                <div class="card-title">
                    <i class="fas fa-pen-alt"></i> New reservation
                </div>

                <!-- form with method POST (same structure, but added interactive features) -->
                <form method="POST" id="turfForm">
                    <!-- name field with icon -->
                    <div class="input-group">
                        <i class="fas fa-user"></i>
                        <input type="text" name="name" placeholder="Your full name" required>
                    </div>

                    <!-- date field with icon -->
                    <div class="input-group">
                        <i class="fas fa-calendar-alt"></i>
                        <input type="date" name="date" required id="bookingDate">
                    </div>

                    <!-- slot dropdown with icon -->
                    <div class="input-group">
                        <i class="fas fa-clock"></i>
                        <select name="slot" required id="slotSelect">
                            <option value="" disabled selected>‚è≥ Choose time slot</option>
                            <option value="6AM - 7AM">üåÖ 6AM - 7AM</option>
                            <option value="7AM - 8AM">‚òÄÔ∏è 7AM - 8AM</option>
                            <option value="5PM - 6PM">üåÜ 5PM - 6PM</option>
                            <option value="6PM - 7PM">üåô 6PM - 7PM</option>
                            <option value="7PM - 8PM">‚ú® 7PM - 8PM</option>
                        </select>
                    </div>

                    <!-- EXTRA FEATURE: slot quick-picker pills (interactive) -->
                    <div class="slot-visual">
                        <span class="pill-slot" data-slot="6AM - 7AM"><i class="far fa-sun"></i> 6-7AM</span>
                        <span class="pill-slot" data-slot="7AM - 8AM"><i class="far fa-sun"></i> 7-8AM</span>
                        <span class="pill-slot" data-slot="5PM - 6PM"><i class="far fa-moon"></i> 5-6PM</span>
                        <span class="pill-slot" data-slot="6PM - 7PM"><i class="far fa-moon"></i> 6-7PM</span>
                        <span class="pill-slot" data-slot="7PM - 8PM"><i class="far fa-moon"></i> 7-8PM</span>
                    </div>

                    <!-- submit button with icon -->
                    <button type="submit" class="btn-gradient">
                        <i class="fas fa-check-circle"></i> Confirm booking
                    </button>
                </form>

                <!-- extra micro feature: today's date hint -->
                <div style="margin-top: 18px; font-size:0.85rem; color:#3a5f8b; background: rgba(43,108,223,0.05); padding:8px 15px; border-radius:40px; text-align:center;">
                    <i class="fas fa-info-circle"></i> Tip: click on any pill to fill the slot instantly
                </div>
            </div>

            <!-- RIGHT CARD: BOOKINGS TABLE + ACTIONS -->
            <div class="table-wrapper">
                <div class="table-header">
                    <h2><i class="fas fa-list-check"></i> Booking history</h2>
                    <div class="chip-info"><i class="fas fa-database"></i> last updated: just now</div>
                </div>

                <!-- table with jinja loop -->
                <table class="booking-table">
                    <thead>
                        <tr>
                            <th>#ID</th>
                            <th><i class="fas fa-user"></i> Name</th>
                            <th><i class="fas fa-calendar"></i> Date</th>
                            <th><i class="fas fa-clock"></i> Slot</th>
                            <th><i class="fas fa-sliders-h"></i> Action</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <!-- JINJA LOOP (original logic preserved) -->
                        {% for b in bookings %}
                        <tr>
                            <td><span style="background:#eef3fc; padding:5px 10px; border-radius:40px;">{{ b[0] }}</span></td>
                            <td><i class="fas fa-circle" style="color:#2b6cdf; font-size:0.6rem; margin-right:6px;"></i>{{ b[1] }}</td>
                            <td>{{ b[2] }}</td>
                            <td><span style="background:#deeafc; padding:4px 12px; border-radius:40px;">{{ b[3] }}</span></td>
                            <td>
                                <a href="/delete/{{ b[0] }}" class="delete-link">
                                    <i class="fas fa-trash-alt"></i> Delete
                                </a>
                            </td>
                        </tr>
                        {% endfor %}

                        <!-- if no bookings, show placeholder (just for demo elegance) -->
                        {% if bookings|length == 0 %}
                        <tr>
                            <td colspan="5" class="empty-message">
                                <i class="fas fa-moon-stars" style="font-size:2rem; opacity:0.6; margin-bottom:10px; display:block;"></i>
                                No bookings yet ‚Äî be the first!
                            </td>
                        </tr>
                        {% endif %}
                    </tbody>
                </table>

                <!-- extra interactive feature: quick delete all (just style, actual delete all not in original spec, but we add a dummy for flair) -->
                <div style="display: flex; justify-content: flex-end; margin-top: 20px;">
                    <span style="background: transparent; padding:8px 15px; border-radius:50px; color:#526f9e; border:1px dashed #9bb6d0;">
                        <i class="fas fa-arrow-right"></i> click on red delete to remove
                    </span>
                </div>
            </div>
        </div>

        <!-- live extra: current time + date (interactive) -->
        <div class="live-indicator">
            <span><i class="fas fa-wifi"></i> live ¬∑ </span>
            <span id="currentTime"></span>
            <span><i class="fas fa-cloud-sun"></i> pitch dry</span>
        </div>
    </div>

    <!-- small script for interactive UI (slot pills, dynamic counter, time) -->
    <script>
        (function() {
            // 1) slot pill click: set dropdown and highlight
            const pills = document.querySelectorAll('.pill-slot');
            const slotSelect = document.getElementById('slotSelect');
            if (pills && slotSelect) {
                pills.forEach(pill => {
                    pill.addEventListener('click', function(e) {
                        const slotValue = this.getAttribute('data-slot');
                        // find option with matching value (roughly)
                        for (let opt of slotSelect.options) {
                            if (opt.value === slotValue) {
                                opt.selected = true;
                                break;
                            }
                        }
                        // optional: give visual feedback
                        pills.forEach(p => p.style.background = 'rgba(230, 240, 255, 0.8)');
                        this.style.background = '#2b6cdf';
                        this.style.color = 'white';
                    });
                });
            }

            // 2) update booking counter based on table rows (if jinja renders rows)
            function updateCounter() {
                const tbody = document.getElementById('tableBody');
                if (!tbody) return;
                // count rows that are not empty placeholder (td with colspan case)
                let rowCount = 0;
                const rows = tbody.querySelectorAll('tr');
                rows.forEach(row => {
                    // if it's not the empty message row (colspan=5)
                    if (!row.querySelector('td[colspan="5"]')) {
                        rowCount++;
                    }
                });
                const counterSpan = document.getElementById('bookingCount');
                if (counterSpan) counterSpan.innerText = rowCount;
            }

            // 3) set today's date as default in date picker (optional but nice)
            const dateInput = document.getElementById('bookingDate');
            if (dateInput) {
                const today = new Date();
                const yyyy = today.getFullYear();
                const mm = String(today.getMonth() + 1).padStart(2, '0');
                const dd = String(today.getDate()).padStart(2, '0');
                dateInput.value = `${yyyy}-${mm}-${dd}`;
            }

            // 4) live clock
            function updateClock() {
                const now = new Date();
                const timeStr = now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
                const el = document.getElementById('currentTime');
                if (el) el.innerHTML = `<i class="far fa-clock"></i> ${timeStr}`;
            }
            setInterval(updateClock, 1000);
            updateClock();

            // initialize counter after small delay (so jinja populates)
            setTimeout(updateCounter, 50);
            // also observe if any delete happens? we don't control backend, but ui remains.
            // just for demo, we call again.
        })();
    </script>
</body>
</html>